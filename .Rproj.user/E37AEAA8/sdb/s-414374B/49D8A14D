{
    "contents" : "---\noutput: pdf_document\n---\n```{r knitr_options, include=FALSE}\nknitr::opts_chunk$set(fig.width=9, warning=FALSE, message=TRUE, include=TRUE, echo=FALSE)\nset.seed(53079239)\n```\n# Brief analysis of the ToothGrowth dataset in R #  \n### Author: D.Aiazzi ###  \n## Overview ##  \nFor the second part of the course work of the Statistical Inference class, we're going to analyze the ToothGrowth data in the R datasets package. These are the project instructions: \n\n1. Load the ToothGrowth data and perform some basic exploratory data analyses \n2. Provide a basic summary of the data.\n3. Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. \n    \n## Exploratory analyses ##\n\nThe ToothGrowth dataset shows the growth of odontoblasts (teeth) in each of 10 guinea pigs at each of three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods (orange juice or ascorbic acid). \nThe data frame is composed of 60 observations on 3 variables:  \n- **len**: \tTooth length (numeric)\n- **supp**: Supplement type (VC for abosrbis acid, OJ for orange juice) (factor) \n- **dose**: Dose in milligrams (factor) \n\n```{r Overlook at the data}\ndata(ToothGrowth)\ndf <- ToothGrowth\nrm(ToothGrowth)\ndf$dose <- as.factor(df$dose)\nhead(df)\nstr(df)\n```\n\nA quick summary shows the data range that goes from a minimum of `r min(df$len)` to a maximum of `r max(df$len)`, with a mean `r round(mean(df$len), 2)` and median `r round(median(df$len), 2)`.    \n\n```{r Summary of the data}\nsummary(df$len)\n```\n\nThe following graphs show the measured length divided by delivery methods and by dose. \n\n```{r Explanatory graph 1, fig.height = 8}\nlibrary(ggplot2)\nggplot(df, aes(dose, len)) + \n    geom_boxplot(aes(fill = dose)) +\n    facet_grid(supp ~ .) +\n    ggtitle(\"Tooth growth in guinea pigs\\nby dose and by delivery method of vitamin C\") +\n    coord_flip()\n```\n\nFrom the first graphs, it seems that there is a positive correlation between the dose and the length. It also seems that OJ permforms better overall, although with higher variance for dose 0.5 and 1.  \nIt seems iteresting to test the difference in response to the two different methods and the difference in response to different dosages.  \n\n```{r Explanatory graph 2, fig.height = 7}\nggplot(df, aes(x = len)) +\n    geom_histogram(aes(fill = dose), binwidth = 1) +\n    ggtitle(\"Probability density function\\nof the length by dose and method\") +\n    facet_grid(supp ~ dose)\n```\n\nThe second graph shows the density of the length mesurements for each pair dose/method.\nIt is assumed that the data distribution is normal and given the small size of the sample, t-intervals will be used for the hypothesis tests.  \n\n## Hypothesis test ##   \n\n```{r Set data and variables for the test}\nOJ0.5 <- df[df$supp == \"OJ\" & df$dose == 0.5, 1]\nOJ1.0 <- df[df$supp == \"OJ\" & df$dose == 1, 1]\nOJ2.0 <- df[df$supp == \"OJ\" & df$dose == 2, 1]\nVC0.5 <- df[df$supp == \"VC\" & df$dose == 0.5, 1]\nVC1.0 <- df[df$supp == \"VC\" & df$dose == 1, 1]\nVC2.0 <- df[df$supp == \"VC\" & df$dose == 2, 1]\n\nvar.equal <- FALSE\nconf.level <- .975\n```\n\nWe want to first understand if the difference in tooth growth is explained by higher levels of vitamin C delivered.  \nWe set our null hypothesis that a lower supply gives the same length of a higher one and we test separately the two methods. We calculate the t-interval for each pair of dose, divided by group. \n\n```{r Compare doses for different methods}\nt.test(OJ1.0,OJ0.5, paired = FALSE, var.equal = var.equal)\nt.test(OJ2.0,OJ1.0, paired = FALSE, var.equal = var.equal)\nt.test(OJ2.0,OJ0.5, paired = FALSE, var.equal = var.equal)\n\nt.test(VC1.0,VC0.5, paired = FALSE, var.equal = var.equal)\nt.test(VC2.0,VC1.0, paired = FALSE, var.equal = var.equal)\nt.test(VC2.0,VC0.5, paired = FALSE, var.equal = var.equal)\n```\n\nThe null hypothesis that the difference is zero is rejected for all of the cases, meaning that there is a statistically significant correletion between the dose and the tooth growth for both methods of delivery.\n\nWe then test the hypothesis that there is a statistical difference between the two supply methods, taking as null hypothesis that OJ performs the same as VC.\n\n```{r Compare OJ and VC}\nt.test(len ~ supp, paired = FALSE, var.equal = var.equal, data = df, conf.level = conf.level)\n```\n\nThe t test over the two samples fails to reject the null hypothesis. The two methods overall performs the same, although the p-value is very close to 0.05, indicating that there might be statistical significancy and that further test with larger samples could be worth doing.  \n\nLet's see in detail the difference between the two methods for each dose.\n\n```{r Compare OJ and VC detailed by dose}\nt.test(OJ0.5,VC0.5, paired = FALSE, var.equal = var.equal)\nt.test(OJ1.0,VC1.0, paired = FALSE, var.equal = var.equal)\nt.test(OJ2.0,VC2.0, paired = FALSE, var.equal = var.equal)\n```\n\nOJ performs better at smaller doses (0.5 and 1), but for higher doses (2) the difference between the two methods is not statistically significant.\n\n## Conclusions ##\nThe hypothesis tests have been conducted under the assumptions that the data distribution is normal and that the variance is not constant amongst the groups.    \n\nThere is a direct correlation between the amount of vitamin C delivered and the tooth growth. OJ is found to perform better then VC at smaller doses, whether OJ and VC permorm the same at higher doses.\n \n ***\n \n## Code ##\n\n```{r Code, echo=TRUE, eval=FALSE}\n## Overlook at the data ##\ndata(ToothGrowth)\ndf <- ToothGrowth\nrm(ToothGrowth)\ndf$dose <- as.factor(df$dose)\nhead(df)\nstr(df)\n\n## Summary of the data ##\nsummary(df$len)\n\n## Explanatory graph 1 ##\nlibrary(ggplot2)\nggplot(df, aes(dose, len)) + \n    geom_boxplot(aes(fill = dose)) +\n    facet_grid(supp ~ .) +\n    ggtitle(\"Tooth growth in guinea pigs\\nby dose and by delivery method of vitamin C\") +\n    coord_flip()\n\n## Explanatory graph 2 ##\nggplot(df, aes(x = len)) +\n    geom_histogram(aes(fill = dose), binwidth = 1) +\n    ggtitle(\"Probability density function\\nof the length by dose and method\") +\n    facet_grid(supp ~ dose)\n\n## Set data and variables for the test ##\nOJ0.5 <- df[df$supp == \"OJ\" & df$dose == 0.5, 1]\nOJ1.0 <- df[df$supp == \"OJ\" & df$dose == 1, 1]\nOJ2.0 <- df[df$supp == \"OJ\" & df$dose == 2, 1]\nVC0.5 <- df[df$supp == \"VC\" & df$dose == 0.5, 1]\nVC1.0 <- df[df$supp == \"VC\" & df$dose == 1, 1]\nVC2.0 <- df[df$supp == \"VC\" & df$dose == 2, 1]\n\nvar.equal <- FALSE\nconf.level <- .975\n\n## Do bigger doses correspond to higher tooth growth ##\n# Method OJ #\nt.test(OJ1.0,OJ0.5, paired = FALSE, var.equal = var.equal)\nt.test(OJ2.0,OJ1.0, paired = FALSE, var.equal = var.equal)\nt.test(OJ2.0,OJ0.5, paired = FALSE, var.equal = var.equal)\n# Method VC #\nt.test(VC1.0,VC0.5, paired = FALSE, var.equal = var.equal)\nt.test(VC2.0,VC1.0, paired = FALSE, var.equal = var.equal)\nt.test(VC2.0,VC0.5, paired = FALSE, var.equal = var.equal)\n\n## Do OJ and VC perform differently overall? ##\nt.test(len ~ supp, paired = FALSE, var.equal = var.equal, data = df, conf.level = conf.level)\n\n## Do OJ and VC perform differently by dose? ##\nt.test(OJ0.5,VC0.5, paired = FALSE, var.equal = var.equal)\nt.test(OJ1.0,VC1.0, paired = FALSE, var.equal = var.equal)\nt.test(OJ2.0,VC2.0, paired = FALSE, var.equal = var.equal)\n```\n\n\n\n",
    "created" : 1430381958079.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "288008585",
    "id" : "49D8A14D",
    "lastKnownWriteTime" : 1430381980,
    "path" : "~/Documents/00_Documents/Coursera/Data Science/06_Statistical Inference/SI_assignement02/Assignement02.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}